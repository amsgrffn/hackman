{{!< default}}
{{> "layout/site-header"}}
{{!-- Tag template with enhanced styling --}}
<main class="tag-content">
    <div class="container">
        {{#tag}}
        <!-- Tag Header Section -->
        <section class="tag-header">
            <header class="tag-header-content">
                <h1 class="tag-title">#{{name}}</h1>
                {{#if description}}
                <p class="tag-description">{{description}}</p>
                {{/if}}
                <div class="tag-meta">
                    <span class="tag-count">{{plural ../pagination.total empty="No posts" singular="% post" plural="% posts"}}</span>
                    {{#if feature_image}}
                    <img class="tag-image" src="{{img_url feature_image size="small"}}" alt="{{name}}">
                    {{/if}}
                </div>
            </header>
        </section>
        {{/tag}}

        <div class="layout">
            <div class="content">
                <!-- Filter Navigation -->
                <div class="filter-nav">
                    <div class="filter-tabs">
                        <a href="{{tag.url}}" class="filter-tab active">All</a>
                        <a href="{{tag.url}}?filter=featured" class="filter-tab">Featured</a>
                        <a href="{{tag.url}}?filter=latest" class="filter-tab">Latest</a>
                    </div>
                </div>

                <!-- Posts Container -->
                <div class="posts-container">
                    {{#foreach posts}}
                    <article class="{{post_class}}">
                        <div class="card">
                            {{#if feature_image}}
                            <img class="card-image" src="{{img_url feature_image size="medium"}}" alt="{{title}}">
                            {{/if}}
                            <div class="card-content">
                                <div class="meta">
                                    {{#primary_tag}}
                                    <span class="tag">{{name}}</span>
                                    {{/primary_tag}}
                                    <span>{{date published_at format="MMM D, YYYY"}}</span>
                                    {{#if reading_time}}
                                    <span>{{reading_time}}</span>
                                    {{/if}}
                                </div>
                                <h2><a href="{{url}}">{{title}}</a></h2>
                                <p>{{excerpt words="25"}}</p>
                                <a href="{{url}}" class="readmore">Read More
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M5 12h14"></path>
                                        <path d="m12 5 7 7-7 7"></path>
                                    </svg>
                                </a>
                            </div>
                            <footer>
                                <p class="author">By {{primary_author.name}}</p>
                                <div class="post-actions dropdown">
                                    <button class="dropbtn" aria-label="Post actions">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="12" cy="12" r="1"></circle>
                                            <circle cx="19" cy="12" r="1"></circle>
                                            <circle cx="5" cy="12" r="1"></circle>
                                        </svg>
                                    </button>
                                    <div class="dropdown-content">
                                        <a href="#" class="copy-url">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                            </svg>
                                            Copy link
                                        </a>
                                        <a href="#" class="email-share">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                                                <polyline points="22,6 12,13 2,6"></polyline>
                                            </svg>
                                            Share via Email
                                        </a>
                                        <a href="#" class="native-share" style="display: none;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                                                <polyline points="16 6 12 2 8 6"></polyline>
                                                <line x1="12" y1="2" x2="12" y2="15"></line>
                                            </svg>
                                            Share
                                        </a>
                                    </div>
                                </div>
                            </footer>
                        </div>
                    </article>
                    {{else}}
                    <div class="no-posts">
                        <p>No posts found matching this tag.</p>
                    </div>
                    {{/foreach}}
                </div>

                <!-- Pagination -->
                {{#if pagination}}
                <div class="pagination">
                    <div class="pagination-navigation">
                        {{#if pagination.prev}}
                            <a class="newer-posts" href="{{page_url pagination.prev}}">&larr; Newer Posts</a>
                        {{/if}}
                        <span class="page-number">Page {{pagination.page}} of {{pagination.pages}}</span>
                        {{#if pagination.next}}
                            <a class="older-posts" href="{{page_url pagination.next}}">Older Posts &rarr;</a>
                        {{/if}}
                    </div>
                </div>
                {{/if}}
            </div>

            <!-- Sidebar -->
            <aside class="sidebar">
                <!-- Search -->
                <div class="search-container">
                    <div class="topbar-search">
                        <div class="topbar-search-left">
                           {{> "icons/search"}}
                            <span class="topbar-search-text">Search Everything</span>
                        </div>
                        <div class="topbar-search-shortcut">⌘K</div>
                    </div>
                </div>
                <!-- About -->
                <div class="about-site">
                    <div class="about-site-header">
                        <h3 class="about-site-title">About This Site</h3>
                        <div class="about-site-icon">
                            <img src="{{asset "media/img/avatar.jpg"}}" alt="Site avatar">
                        </div>
                    </div>
                    <p class="about-site-description">We use this electronic scrapbook to stay more or less sane and charitable. Planet is a marvelous nuthouse if you haven't noticed and equanimity created is closer than equanimity found. Topics vary.</p>
                    <div class="about-site-stats">
                        <div class="site-stat">
                            <span class="stat-value">500</span>
                            <span class="stat-label">Articles</span>
                        </div>
                        <div class="site-stat">
                            <span class="stat-value">100</span>
                            <span class="stat-label">Members</span>
                        </div>
                        <div class="site-stat">
                            <span class="stat-value">5.0%</span>
                            <span class="stat-label">To Charities</span>
                        </div>
                    </div>
                    <a href="{{@site.url}}/about/" class="about-site-link">Learn more</a>
                </div>
                <!-- Newsletter -->
                <div class="newsletter-container">
                    <div class="newsletter-header">
                        <h3 class="newsletter-title">Subscribe to Newsletter</h3>
                        <p class="newsletter-description">Get the latest posts delivered right to your inbox.</p>
                    </div>
                    <form class="newsletter-form">
                        <input type="email" class="newsletter-input" placeholder="jules@badmotherfucker.com" required>
                    </form>
                    <p class="newsletter-footnote">We'd sooner drink Drāno than share your personal info. You can cancel us whenever you'd like.</p>
                </div>

                <!-- Sidebar Section for Pages -->
                <div class="sidebar-section">
                    <!-- Related Tags section -->
                    <div class="collapsible-section">
                        <div class="collapsible-header">
                            <span class="collapsible-title">Related Tags</span>
                            <svg class="collapsible-icon" width="12" height="12" viewBox="0 0 12 12">
                                <path fill="currentColor" d="M6 8.825l-4.9-4.9c-.3-.3-.3-.75 0-1.05.3-.3.75-.3 1.05 0L6 6.725l3.85-3.85c.3-.3.75-.3 1.05 0 .3.3.3.75 0 1.05l-4.9 4.9z"/>
                            </svg>
                        </div>
                        <div class="collapsible-content">
                            <ul class="page-list">
                                {{#get "tags" limit="10" include="count.posts" order="count.posts desc"}}
                                {{#foreach tags}}
                                <li class="page-item">
                                    <a href="{{url}}" class="page-link">
                                        <span class="page-icon">#</span>
                                        <span>{{name}}</span>
                                    </a>
                                </li>
                                {{/foreach}}
                                {{/get}}
                            </ul>
                        </div>
                    </div>

                    <!-- Testimonials -->
                    <div class="collapsible-section">
                        <div class="collapsible-header">
                            <span class="collapsible-title">Testimonials</span>
                            <svg class="collapsible-icon" width="12" height="12" viewBox="0 0 12 12">
                                <path fill="currentColor" d="M6 8.825l-4.9-4.9c-.3-.3-.3-.75 0-1.05.3-.3.75-.3 1.05 0L6 6.725l3.85-3.85c.3-.3.75-.3 1.05 0 .3.3.3.75 0 1.05l-4.9 4.9z"/>
                            </svg>
                        </div>
                        <div class="collapsible-content">
                            <div class="content-box quotes">
                                <div class="testimonials">
                                    <blockquote id="testimonal">
                                        <div class="testimonial-content"></div>
                                    </blockquote>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Other collapsible sections -->
                    <div class="collapsible-section">
                        <div class="collapsible-header">
                            <span class="collapsible-title">Policies</span>
                            <svg class="collapsible-icon collapsed" width="12" height="12" viewBox="0 0 12 12">
                                <path fill="currentColor" d="M6 8.825l-4.9-4.9c-.3-.3-.3-.75 0-1.05.3-.3.75-.3 1.05 0L6 6.725l3.85-3.85c.3-.3.75-.3 1.05 0 .3.3.3.75 0 1.05l-4.9 4.9z"/>
                            </svg>
                        </div>
                        <div class="collapsible-content hidden">
                            <ul class="page-list">
                                <li class="page-item">
                                    <a href="#" class="page-link">
                                        {{> "icons/crown"}}
                                        <span>House Rules</span>
                                    </a>
                                </li>
                                <li class="page-item">
                                    <a href="#" class="page-link">
                                        <svg class="page-icon" width="18" height="18" viewBox="0 0 18 18">
                                            <path fill="currentColor" d="M9 1.5c4.125 0 7.5 3.375 7.5 7.5s-3.375 7.5-7.5 7.5-7.5-3.375-7.5-7.5 3.375-7.5 7.5-7.5zm0 13.5c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6zm-1.5-6.75h3v1.5h-3v-1.5zm0-3h3v1.5h-3v-1.5z"/>
                                        </svg>
                                        <span>Privacy Policy</span>
                                    </a>
                                </li>
                                <li class="page-item">
                                    <a href="#" class="page-link">
                                        <svg class="page-icon" width="18" height="18" viewBox="0 0 18 18">
                                            <path fill="currentColor" d="M3.75 16.5c-.825 0-1.5-.675-1.5-1.5V3c0-.825.675-1.5 1.5-1.5h10.5c.825 0 1.5.675 1.5 1.5v12c0 .825-.675 1.5-1.5 1.5h-10.5zm0-1.5h10.5V3h-10.5v12zm2.25-9h6v-1.5H6v1.5zm0 3h6v-1.5H6v1.5zm0 3h6v-1.5H6v1.5z"/>
                                        </svg>
                                        <span>Terms of Service</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="collapsible-section">
                        <div class="collapsible-header">
                            <span class="collapsible-title">Elsewhere</span>
                            <svg class="collapsible-icon collapsed" width="12" height="12" viewBox="0 0 12 12">
                                <path fill="currentColor" d="M6 8.825l-4.9-4.9c-.3-.3-.3-.75 0-1.05.3-.3.75-.3 1.05 0L6 6.725l3.85-3.85c.3-.3.75-.3 1.05 0 .3.3.3.75 0 1.05l-4.9 4.9z"/>
                            </svg>
                        </div>
                        <div class="collapsible-content hidden">
                            <ul class="page-list">
                                <li class="page-item">
                                    <a href="#" class="page-link">
                                        {{> "icons/at-sign"}}
                                        <span>Contact Us</span>
                                    </a>
                                </li>
                                <li class="page-item">
                                    <a href="#" class="page-link">
                                        {{> "icons/lamp"}}
                                        <span>Office Hours</span>
                                    </a>
                                </li>
                                <li class="page-item">
                                    <a href="#" class="page-link">
                                        {{> "icons/circuit"}}
                                        <span>Nerd Alert</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>
</main>

<style>
.tag-header {
    background-color: var(--gray-dark);
    color: var(--secondary-color);
    padding: var(--space-xl) 0;
    margin-bottom: var(--space-xl);
    border-radius: var(--radius);
}

.tag-header-content {
    text-align: center;
    padding: var(--space-xl) var(--space-xl);
}

.tag-title {
    font-family: var(--display);
    font-size: clamp(2.5rem, 5vw, 3.5rem);
    font-weight: var(--font-weight-bold);
    letter-spacing: var(--letter-spacing-tight);
    margin-bottom: var(--space-md);
    color: var(--secondary-color);
}

.tag-description {
    font-size: var(--text-xl);
    max-width: 700px;
    margin: 0 auto var(--space-lg);
    line-height: var(--line-height-relaxed);
    opacity: 0.9;
}

.tag-meta {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--space-md);
    font-size: var(--text-sm);
    opacity: 0.8;
}

.tag-image {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
}

.tag-count {
    font-family: var(--mono);
    font-size: var(--text-sm);
}

.filter-nav {
    margin-bottom: var(--space-xl);
}

.filter-tabs {
    display: flex;
    gap: var(--space-md);
    border-bottom: 1px solid var(--gray-light);
    padding-bottom: var(--space-xs);
}

.filter-tab {
    color: var(--gray-medium);
    font-size: var(--text-sm);
    font-weight: var(--font-weight-medium);
    padding: var(--space-xs) var(--space-sm);
    border-radius: 100px;
    transition: var(--transition);
}

.filter-tab.active, .filter-tab:hover {
    color: var(--accent-color);
    background-color: rgba(0, 122, 255, 0.1);
}

.no-posts {
    background-color: var(--secondary-color);
    border-radius: var(--radius);
    padding: var(--space-xl);
    text-align: center;
    margin-bottom: var(--space-xl);
    box-shadow: var(--shadow);
}

.pagination {
    margin: var(--space-xl) 0;
    text-align: center;
}

.pagination-navigation {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--space-md);
}

.pagination-navigation a {
    color: var(--accent-color);
    background-color: var(--secondary-color);
    padding: var(--space-xs) var(--space-sm);
    border-radius: 100px;
    font-size: var(--text-sm);
    font-weight: var(--font-weight-medium);
    transition: var(--transition);
}

.pagination-navigation a:hover {
    background-color: var(--accent-color);
    color: var(--secondary-color);
}

.page-number {
    color: var(--gray-medium);
    font-size: var(--text-sm);
}

/* Card hover enhancements */
.card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
}

/* Mobile optimizations */
@media (max-width: 767px) {
    .tag-header-content {
        padding: var(--space-lg) var(--space-md);
    }

    .tag-description {
        font-size: var(--text-lg);
    }

    .filter-tabs {
        overflow-x: auto;
        padding-bottom: var(--space-sm);
        -webkit-overflow-scrolling: touch;
    }

    .pagination-navigation {
        flex-direction: column;
        gap: var(--space-sm);
    }
}
</style>